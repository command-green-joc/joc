<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>War Room v5.2 - Command.Green</title>
  <link rel="icon" href="/favicon.ico">
  <style>
    body { background: #000; color: #0f0; font-family: 'Courier New', monospace; margin: 0; }
    .warroom { padding: 20px; }
    .header { color: #f00; font-size: 32px; text-align: center; }
    .tabs { display: flex; border-bottom: 1px solid #0f0; margin-bottom: 20px; }
    .tab { padding: 10px 20px; cursor: pointer; border: 1px solid #0f0; margin-right: 5px; }
    .tab.active { background: #0f0; color: #000; }
    .panel { display: none; padding: 20px; border: 1px solid #0f0; }
    .panel.active { display: block; }
    .signal { color: cyan; animation: blink 1s infinite; }
    @keyframes blink { 50% { opacity: 0; } }
    .alert { color: #f00; animation: pulse 2s infinite; margin: 10px 0; }
    @keyframes pulse { 50% { opacity: 0.5; } }
    .source { font-size: 12px; color: #666; }
  </style>
</head>
<body>
  <div class="warroom">
    <h1 class="header">WAR ROOM v5.2 ACTIVE</h1>
    
    <div class="tabs">
      <div class="tab active" onclick="openTab('signals')">Live Signals</div>
      <div class="tab" onclick="openTab('defenders')">Defend the Defenders</div>
    </div>

    <div id="signals" class="panel active">
      <p class="signal">LIVE: Shell spill reported — Niger Delta (OpenOil)</p>
      <p class="signal">PENDING: Seismic survey update — East Coast SA (Amnesty)</p>
    </div>

    <div id="defenders" class="panel">
      <h3>Defend the Defenders — Bluesky Feed</h3>
      <div id="blueskyFeed">Loading live alerts...</div>
    </div>

    <p>v5.2 — Truth Engine: BLUESKY + 6 APIS</p>
    <a href="/" style="color:cyan;">← Return to JOC</a>
  </div>

  <script>
    function openTab(tabName) {
      document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.getElementById(tabName).classList.add('active');
      document.querySelector(`[onclick="openTab('${tabName}')"]`).classList.add('active');
      if (tabName === 'defenders') loadBluesky();
    }

    async function loadBluesky() {
      const feed = document.getElementById('blueskyFeed');
      try {
        const res = await fetch('/api/bluesky', { cache: 'no-store' });
        const posts = await res.json();
        feed.innerHTML = posts.map(p => 
          `<div class="alert">URGENT: ${p.text} — @${p.author} (${p.time})</div>`
        ).join('');
      } catch (e) {
        feed.innerHTML = '<p class="alert">BLUESKY FEED OFFLINE</p>';
      }
    }

    setInterval(loadBluesky, 30000); // Refresh every 30s
  </script>
<footer style="margin-top: 40px; font-size: 12px; color: #666; text-align: center;">
  Powered by 10+ APIs and Targeted Bots. Truth Engine v5.3
</footer>
</body>
</html>
